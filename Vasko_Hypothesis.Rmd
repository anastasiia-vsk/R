---
title: "Перевірка статистичних гіпотез"
output: html_notebook
---

# Завдання 1

Завантажуємо дані.

```{r}
data <- c(8.36043, 9.84681, 11.0165, 10.3691, 11.1062, 11.5748, 10.4819, 9.57465, 9.15738, 9.10535,
9.58175, 8.84759, 10.2, 11.4585, 9.39668, 10.3133, 8.78169, 9.27218, 10.5407, 9.83173,
10.9303, 10.0612, 9.83532, 9.19267, 10.4731, 10.1689, 8.83445, 9.57088, 10.199, 10.5173,
8.79799, 9.85155, 10.3257, 10.6566, 10.8768, 10.2083, 11.0509, 10.6774, 9.11585, 8.07112,
9.64491, 9.42134, 10.0062, 10.4985, 10.7303, 9.32261, 9.14602, 11.2338, 9.23383, 9.48719,
9.5061, 11.9317, 9.78455, 10.4451, 10.9098, 9.09558, 9.98835, 9.82078, 10.666, 9.76885,
10.2057, 9.7456, 8.81365, 8.5658, 10.2601, 10.3143, 10.2994, 12.8814, 10.4079, 9.30728,
10.738, 10.5298, 9.83119, 10.1446, 10.1131, 10.5583, 7.55672, 10.1561, 8.66302, 11.775,
10.1366, 8.99592, 8.95801, 7.88063, 9.5622, 7.47275, 10.9187, 9.28612, 10.2589, 9.5277,
10.0065, 11.5258, 11.3286, 9.98597, 9.98792, 8.11203, 11.7729, 10.6381, 10.2778, 9.70833,
9.59371, 10.7766, 10.9967, 10.7246, 8.89588, 7.76889, 10.7267, 10.5506, 10.1092, 11.3371,
10.6461, 9.43656, 9.40437, 7.27759, 8.45498, 11.5526, 10.1994, 11.7905, 10.0322, 10.7253,
10.1166, 11.6038, 10.8114, 10.977, 9.76245, 10.8306, 9.62841, 10.2817, 8.51568, 10.1304,
10.5641, 10.7866, 9.72824, 9.66259, 9.45735, 10.4983, 11.5839, 9.17528, 10.7448, 11.3197,
10.5773, 9.0155, 10.7491, 10.6606, 11.9538, 11.2009, 10.2015, 10.1946, 9.39697, 9.17197,
11.231, 8.76378, 9.39774, 8.94573, 10.785, 10.44, 10.6711, 10.6249, 8.61901, 10.134,
8.72391, 9.62927, 9.81301, 9.30987, 10.3448, 7.9121, 12.0301, 10.6998, 11.9495, 10.1075,
9.38487, 10.4665, 9.73367, 10.6054, 9.6666, 9.81792, 10.6, 10.3823, 10.5618, 10.2501
)
```

```{r}
head(data, 10)
```

### Завдання 1.

Побудувати графік щільності розподілу випадкової величини ваги коробки і визначити візуально схожість із нормальним законом розподілу.

```{r}
plot(density(data), main="Щільність розподілу ваги коробки", ylab="Щільність", xlab="Вага коробки")
```

```{r}
hist(data, main="Щільність розподілу ваги коробки", xlab="Вага коробки", ylab="Частота", col="lightblue", border="black")
```

***Висновок: маємо схожість із нормальни законом розподілу.***

### Завдання 2.

Перевірити гіпотезу про нормальний закон розподілу з використанням критерію Пірсона (хі-квадрат).

```{r}
chi_squared_test <- chisq.test(data, correct = TRUE, p = rep(1/length(data), length(data), rescale.p = FALSE, simulate.p.value = FALSE))
print(chi_squared_test)
```

***Висновок: Отримане p-значення 1 свідчить про те, що немає статистично значущих відхилень від нормального розподілу в даному наборі даних.***

### Завдання 3.

Перевірити гіпотезу про нормальний закон розподілу з використанням критерію Шапіро-Уілка.

```{r}
shapiro_test <- shapiro.test(data)
print(shapiro_test)
```

***Висновок: Отримане p-значення 0.2943 свідчить про те, що немає статистично значущих відхилень від нормального розподілу в даному наборі даних.***

### Завдання 4.

```{r}
normative_value <- 10
t_test <- t.test(data, mu = normative_value)
print(t_test)
```

***Висновок: Отримане p-значення 0.5388 вказує на те, що відхилення від нормативу в 10 кг може бути розглянуте як незначуще.***

# Завдання 2.

Імпортую дані.

```{r}
data_firm1 <- c(505.80, 518.87, 609.66, 617.83, 612.69, 570.39, 590.47, 587.30, 625.40, 592.67,
515.75, 610.10, 556.13, 581.19, 619.16, 582.87, 587.03, 596.87, 641.82, 625.25,
536.21, 567.42, 562.17, 618.09, 590.85, 600.17, 583.72, 612.28, 649.22, 604.14,
547.09, 542.49, 576.95, 584.77, 647.98, 542.11, 595.48, 614.94, 519.32, 643.29,
636.90, 601.89, 516.25, 586.60, 536.04, 506.26, 626.02, 644.67, 633.36, 601.76,
602.10, 528.52, 559.01, 562.68, 621.49, 603.23, 581.50, 542.37, 601.98, 552.09,
622.28, 523.69, 505.05, 519.60, 613.49, 638.14, 519.61, 554.82, 580.51, 610.98,
646.33, 557.30, 640.77, 600.93, 588.53, 573.53, 543.52, 500.78, 558.12, 540.42,
549.52, 566.26, 623.02, 608.35, 552.04, 508.68, 645.67, 573.13, 526.02, 506.91,
611.97, 524.78, 641.43, 527.76, 518.43, 557.26, 595.86, 527.57, 613.47, 594.05)
```

```{r}
data_firm2 <- c(532.24, 610.29, 505.76, 620.48, 640.18, 550.44, 506.21, 551.78, 570.84, 583.80,
640.50, 644.33, 571.82, 621.35, 567.83, 591.80, 589.01, 555.76, 512.41, 612.62,
582.24, 623.99, 510.45, 563.44, 612.40, 534.26, 578.00, 522.06, 577.15, 564.97,
587.89, 629.24, 627.56, 538.36, 637.30, 598.15, 517.05, 578.52, 506.19, 527.82,
552.62, 647.99, 564.67, 604.17, 631.08, 566.21, 587.81, 546.39, 591.82, 590.80,
575.75, 629.95, 581.34, 561.15, 618.22, 568.51, 547.60, 598.52, 527.60, 622.19,
560.65, 563.30, 530.01, 610.11, 501.88, 607.39, 552.26, 559.68, 561.49, 646.61,
590.48, 572.33, 604.24, 560.19, 505.50, 625.82, 589.18, 583.22, 593.00, 537.37,
513.07, 533.16, 536.07, 518.15, 547.72, 587.49, 507.12, 592.40, 633.52, 613.08,
643.30, 605.31, 506.54, 535.68, 589.78, 541.01, 554.44, 577.81, 596.76, 507.38)
```

### Завдання 1.

Побудувати в одній системі координат точкові графіки щоденної виручки обох фірм. При цьому точки для кожної фірми повинні мати свій колір

```{r}
plot(data_firm1, col = "blue", pch = 16, ylim = c(min(data_firm1, data_firm2), max(data_firm1, data_firm2)),
     xlab = "День", ylab = "Виручка", main = "Щоденна виручка Фірми 1 та Фірми 2")
points(data_firm2, col = "red", pch = 16)
legend("topright", legend = c("Фірма 1", "Фірма 2"), col = c("blue", "red"), pch = 16)
```

### Завдання 2.

Чи можна вважати співставними обсяги щоденної виручки обох фірм? Дати відповідь за результатами перевірки гіпотези про рівність математичних сподівань обсягів виручки двох фірм за критерієм Стьюдента .

```{r}
t_test_firms <- t.test(data_firm1, data_firm2)
print(t_test_firms)
```

***Висновок: На рівні значущості 0.05 результати не вказують на статистично значущу різницю в обсягах щоденної виручки між фірмами.***

***Довірчий інтервал для різниці середніх значень знаходиться між -6.130074 та 16.847274, що включає 0. Це також підтверджує відсутність статистично значущого відхилення між середніми обсягами виручки обох фірм.***

### Завдання 3.

Перевірити для двох фірм гіпотезу про рівність дисперсій обсягів продажу з використанням критерію Фішера.

```{r}
var_test_firms <- var.test(data_firm1, data_firm2)
print(var_test_firms)
```

***Висновок: На рівні значущості 0.05 результати критерію Фішера не вказують на статистично значущу різницю в дисперсіях обсягів виручки між фірмами, оскільки p-value (0.6873) перевищує пороговий рівень, і 95% довірчий інтервал для відношення дисперсій (від 0.73 до 1.61) включає 1.***

***"ratio of variances" - 1.084503, показує, що дисперсії цих двох груп схожі, оскільки вони відхиляються від одиниці на досить невелику величину.***

### Завдання 4.

Провести кореляційний аналіз обсягів продажу двох фірм. Спочатку зробити висновок про взаємозв'язок між ними на основі візуального аналізу, побудувавши два графіка:

1)    графік залежності обсягів продажу фірми 1 від обсягів продажу фірми 2;

2)    графік залежності обсягів продажу фірми 2 від обсягів продажу фірми 1.

```{r}

plot(data_firm1, data_firm2, main = "Обсяг продажів: Фірма 1 проти Фірми 2",
     xlab = "Фірма 1", ylab = "Фірма 2", col = "blue")

plot(data_firm2, data_firm1, main = "Обсяг продажів: Фірма 2 проти Фірми 1",
     xlab = "Фірма 2", ylab = "Фірма 1", col = "red")

par(mfrow = c(1, 1))
```

***Висновок: не видно кореляції.***

### Завдання 5.

Використати критерії Пірсона, Спірмена та Кендалла для перевірки наявності кореляційного зв'язку між обсягами продажів двох фірм.

```{r}
# критерій Пірсона
cor_p <- cor.test(data_firm1, data_firm2, method = "pearson")
print(cor_p)
```

***Висновки: Критерій Пірсона показав, що взаємозв'язок між обсягами продажу фірми 1 і фірми 2 є статистично не значущим (p-value = 0.324), і коефіцієнт кореляції дорівнює -0.099641, вказуючи на слабкий зв'язок.***

```{r}
# критерій Спірмена
cor_s <- cor.test(data_firm1, data_firm2, method = "spearman")
print(cor_s)
```

***Висновки: Критерій Спірмена показав, що взаємозв'язок між обсягами продажу фірми 1 і фірми 2 є статистично не значущим (p-value = 0.372), і коефіцієнт кореляції дорівнює -0.09011701, вказуючи на слабкий зв'язок.***

```{r}
# критерій Кендалла
cor_k <- cor.test(data_firm1, data_firm2, method = "kendall")
print(cor_k)
```

***Висновки: Критерій Кендалла показав, що взаємозв'язок між обсягами продажу фірми 1 і фірми 2 є статистично не значущим (p-value = 0.3199), і коефіцієнт кореляції дорівнює -0.06747475, вказуючи на слабкий зв'язок.***
