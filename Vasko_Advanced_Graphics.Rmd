---
title: "Розширені інструменти візуальної аналітики"
output: html_notebook
---

### **Завдання 1.**

Встановіть пакет *vcd.* Завантажте таблицю *Arthritis*, яка є частиною інстальованого пакету. Таблиця містить дані клінічного випробування, що досліджувало нове лікування ревматоїдного артриту.

```{r}
library(vcd)
Arthritis
```

### **Завдання 2.**

Побудуйте прості стовпчикові вертикальну та горизонтальну діаграми частоти різної реакції (*None, Some, Marked*) досліджуваних пацієнтів на ліки або плацебо. Для цього потрібно використати стовпець *Improved* таблиці *Arthritis*. Для визначення частоти зустрічі окремих значень у векторі або матриці можна використати функцію *table().* Для побудови стовпчикових діаграм можна використати функції *plot* або *barplot.*

Для вертикальної стовпчикової діаграми: заголовок -- «Вертикальна стовпчикова діаграма», заголовок горизонтальної осі -- «Покращення», заголовок вертикальної осі -- «Частота».

Для горизонтальної стовпчикової діаграми: заголовок -- «Горизонтальна стовпчикова діаграма», заголовок горизонтальної осі -- «Частота», заголовок вертикальної осі -- «Покращення».

```{r}
frequency_table <- table(Arthritis$Improved)
frequency_table
```

```{r}
par(mfrow = c(1,2))

barplot(frequency_table, main="Вертикальна стовпчикова діаграма", cex.main = 0.9,
        xlab="Покращення", ylab="Частота", col = "lightgreen")

barplot(frequency_table, main="Горизонтальна стовпчикова діаграма", cex.main = 0.9,
        xlab="Частота", ylab="Покращення", col = "lightblue", horiz=TRUE)
```

### **Завдання 3.**

Побудуйте стовпчикові діаграми з вертикальним та горизонтальним розподілом на підгрупи. Побудова діаграм з групуванням відбувається, якщо в якості аргументу функції *barplot* використовувати не вектор, а матрицю (таблицю).

```{r}
counts <- table(Arthritis$Improved, Arthritis$Treatment)
counts
```

```{r}
par(mfrow = c(1,2))

barplot(counts, main="Стовпчикова діаграма \n з вертикальним розбиттям на підгрупи", cex.main = 0.8, xlab="Лікування", ylab="Частота", col=c("red", "yellow", "green"), legend=rownames(counts))

barplot(counts, main="Стовпчикова діаграма \n з горизонтальним розбиттям на підгрупи", cex.main = 0.8, xlab="Частота", ylab="Лікування", col=c("red", "yellow", "green"), legend=rownames(counts), beside=TRUE)
```

### **Завдання 4.**

Побудуйте спінограми -- особливий варіант стовпчикових діаграм, у яких висота кожного результуючого стовпця дорівнює 1, а висоти його складових відображають пропорції. Спінограми створюються за допомогою команди *spine*() із пакету *vcd*()

Реалізуйте в *R* приклад, який задано наступним скриптом

*library(vcd)*

*attach(Arthritis)*

*counts \<- table(Treatment, Improved)*

*spine(counts, main=\"Приклад спінограми\")*

*detach(Arthritis)*

```{r}
attach(Arthritis)
counts <- table(Treatment, Improved)
spine(counts, main = "Приклад спінограми")
detach(Arthritis)
```

Чи можливо розфарбувати частини спінограми в різні кольори? Якщо так, то зробіть це.

***Я прочитала, що функція "spine" насправді з базового пакету R "graphics", і вона не підтримує задання кольорів. Перевірила:***

```{r}
spine(counts, main = "Приклад спінограми", col = c("red", "yellow", "green"))
```

***Справді, побачила помилку.***

***Проте якщо використати функцію з пакету "vcd" під назвою "spineplot", то буде можливість створити таку саму спінограму і задати кольори.***

```{r}
spineplot(counts, main = "Приклад спінограми", col = c("red", "yellow", "green"))
```

### **Завдання 5.**

Використовуючи R команди для базової візуалізації, відтворіть такий графік: (Датасет, який був використаний для цього зображення *InsectSprays*, який доступний в базовій *R* інсталяції)

*Методичні рекомендації:*

-   *head* і *str* можна використати для перегляду даних;

-   з допомогою команди *par* можна розділити графік на 2 вікна;

-   зобразіть перший boxplot і додайте заголовок і назви осей;

-   зобразіть другий boxplot і додайте заголовок і назви осей.

```{r}
data(InsectSprays)
head(InsectSprays)
```

```{r}
str(InsectSprays)
```

```{r}
par(mfrow = c(1, 2))

boxplot(InsectSprays$count, 
        main = "Boxplot 1 \n Effectiveness of spray",
        xlab = "All sprays", ylab = "Count", col = "beige")

boxplot(InsectSprays$count ~ InsectSprays$spray, 
        main = "Boxplot 2 \n Effectiveness by spray",
        xlab = "Spray type", ylab = "Count", col = "lightpink")
```

### **Завдання 6.**

Для датасету *mtcars* побудуйте вдосконалені діаграми розмахів (*boxplot*), порівнявши витрати пального для автомобілів з чотирма, шістьма та вісьмома циліндрами. При побудові використати додаткові параметри *notch=TRUE, varwidth=TRUE*, які дозволяють зобразити ширину фігур, пропорційну обсягу вибірок. Зафарбуйте фігури на графіку довільним кольором.

```{r}
data(mtcars)
head(mtcars)
```

```{r}
boxplot(mpg ~ cyl, data = mtcars,
        notch = TRUE, varwidth = TRUE, 
        col = c("lightblue", "lightgreen", "lightcoral"),
        main = "Інформація про авто",
        xlab = "Кількість циліндрів", ylab = "Кількість миль на галон (mpg)")
```

### **Завдання 7.**

Функція *boxplot* також дозволяє будувати на одному рисунку діаграми розмахів для декількох факторів. Поставимо, наприклад, задачу дослідити витрати пального не тільки від кількості циліндрів, а й від типу трансмісії автомобіля (механічна чи автоматична).

```{r}
mtcars$cyl.f <- factor(mtcars$cyl, levels = c(4, 6, 8), 
                       labels = c("4ц", "6ц", "8ц"))
mtcars$am.f <- factor(mtcars$am, levels = c(0, 1), 
                      labels = c("АТ", "МТ"))

boxplot(mpg ~ am.f * cyl.f, data = mtcars, varwidth = TRUE,
        col = c("lightblue", "lightpink"),
        main = "Витрати пального від кількості циліндрів та типу трансмісії",
        xlab = "Тип трансмісії", ylab = "Милі на галон (mpg)")
```

### **Завдання 8.**

Для датасету *mtcars* побудуйте ще одну модифікацію діаграм витрат пального для автомобілів з чотирма, шістьма та вісьмома циліндрами -- скрипкові діаграми. Таку діаграму можна створити за допомогою функції *vioplot()* із пакету з такою ж назвою *vioplot*.

```{r}
library(vioplot)
```

```{r}
vioplot(mpg ~ cyl, data = mtcars, 
        names = c("4 циліндри", "6 циліндрів", "8 циліндрів"),
        col = c("lightblue", "lightgreen", "lightcoral"),
        main = "Скрипкові діаграми витрат пального",
        xlab = "Кількість циліндрів", ylab = "Кількість на галон (mpg)")
```
